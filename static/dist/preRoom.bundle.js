(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{103:function(t,e,n){"use strict";n.r(e);var s=n(60),o=n.n(s),l=n(30),i=n.n(l),r=n(64),a=n.n(r);var c=class{constructor(t,e){let n;for(n of(this.pc=new RTCPeerConnection({iceServers:[{urls:"stun:stun.l.google.com:19302"}]}),this.fchannel=e,this.oncontrolmessage=null,this.onremotetrack=null,this.onremotecontrolchannel=null,this.onremotemessagechannel=null,t.getTracks()))this.pc.addTrack(n);this.remotechannel=this.pc.createDataChannel("controller",{negotiated:!0,id:0}),this.messagechannel=this.pc.createDataChannel("message",{negotiated:!0,id:1}),this.remotechannel.onopen=()=>{this.onremotecontrolchannel&&this.onremotecontrolchannel(this.remotechannel)},this.messagechannel.onopen=()=>{this.onremotemessagechannel&&this.onremotemessagechannel(this.messagechannel)},this.remotechannel.onmessage=t=>{this.oncontrolmessage&&this.oncontolmessage(JSON.parse(t.data))},this.pc.onicecandinate=t=>{this.fchannel.send(JSON.stringify({candinate:t.candinate}))},this.pc.ontrack=t=>{this.onremotetrack(t.track)},this.fchannel.onmessage=t=>{const e=JSON.parse(t);e.sdp&&("offer"===e.type?this.pc.setRemoteDescription(new RTCSessionDescription(e)).then(()=>{this.pc.createAnswer().then(t=>{console.log(t),this.pc.setLocalDescription(t),this.fchannel.send(JSON.stringify(t.toJSON()))})}):e.candinate?this.pc.addIceCandinate(new RTCIceCandinate(e.candinate)):this.pc.setRemoteDescription(new RTCSessionDescription(e)))}}call(){this.pc.createOffer().then(t=>{this.pc.setLocalDescription(t),this.fchannel.send(JSON.stringify(t))})}};var d=class{constructor(t,e){this.id=t,this.ref=e,this.onmessage=null,this.ref.on("child_added",t=>{(t=t.val()).id!==this.id&&this.onmessage&&this.onmessage(t.data)})}send(t){this.ref.push({id:this.id,data:t}).then(()=>{}).catch(t=>{console.error("Error writing new message to Firebase Database",t)})}};var h=class{constructor(t,e,n,s,o=null,l=null){this.uid=t,this.stream=s,console.log(this.stream),this.name=e,this.torrent=o,this.connList={},this.onremoteuserset=null,this.ontorrentlearned=null,this.onremotetrackadded=null,this.onremotecontrolchannel=null,this.onmessagechannel=null,this.ondataremoved=null,null===l?(this.roomRef=n.push(),this.roomRef.set({torrent:this.torrent,remoteiswith:this.uid}).then(()=>{this.ontorrentlearned&&this.ontorrentlearned(this.torrent),this.onremoteuserset&&this.onremoteuserset()}),this.roomRef.onDisconnect().remove(),this.id=this.roomRef.key):(this.roomRef=n.child(l),this.roomRef.child("torrent").once("value",t=>{this.torrent=t.val(),this.ontorrentlearned&&this.ontorrentlearned(this.torrent)})),console.log(this.connList),this.roomRef.child("remoteiswith").on("value",t=>{t.val()===this.uid&&(0===Object.keys(this.connList).length?this.roomRef.onDisconnect().remove():this.roomRef.child("remoteiswith").onDisconnect().set(Object.keys(this.connList)[0]),this.onremoteuserset&&this.onremoteuserset()),this.remoteuser=t.val()}),this.currentUser=this.roomRef.child("connList").child(this.uid),this.currentUser.set(this.name),this.currentUser.onDisconnect().remove(),this.roomRef.child("connList").on("child_added",t=>{if(t.key===this.uid)return;0===Object.keys(this.connList).length&&(this.roomRef.onDisconnect().cancel(),this.currentUser.onDisconnect().remove()),this.connList[t.key]=t.val(),this.uid===this.remoteuser&&this.roomRef.child("remoteiswith").onDisconnect().set(Object.keys(this.connList)[0]);const e=[t.key,this.uid];e.sort();const n=this.roomRef.child(`channels/${e[0]}/${e[1]}`),s=new c(this.stream,new d(this.uid,n));this.uid===e[0]&&s.call(),s.onremotetrack=t=>{this.onremotetrackadded&&this.onremotetrackadded(t)},s.onremotecontrolchannel=t=>{console.log(t),this.onremotecontrolchanneladded&&this.onremotecontrolchanneladded(t)},s.onmessagechannel=t=>{this.onmessagechanneladded&&this.onmessagechanneladded(t)}}),this.roomRef.child("connList").on("child_removed",t=>{t.key!==this.uid&&(delete this.connList[t.key],console.log(this.connList),this.ondataremoved&&this.ondataremoved(t.key))})}ChangeRemote(t){this.roomRef.child("remoteiswith").set(t),this.onremoteuserset&&this.remoteuserset(),this.roomReF.child("remoteiswith").onDisconnect().cancel()}},u=n(95),p=n.n(u),m=n(98),y=n(96),v=n.n(y),g=n(97),f=n.n(g);var b=class{constructor(t,e){this.vidElem=e,console.log(this.vidElem),this.Player=new Plyr(this.vidElem,{controls:'\n<div class="plyr__controls">\n<button type="button" class="plyr__control remote-only" aria-label="Play" data-plyr="play">\n<svg class="icon--pressed" role="presentation"><use xlink:href="#plyr-pause"></use></svg>\n<svg class="icon--not-pressed" role="presentation"><use xlink:href="#plyr-play"></use></svg>\n<span class="label--pressed plyr__tooltip" role="tooltip">Pause</span>\n<span class="label--not-pressed plyr__tooltip" role="tooltip">Play</span>\n</button>\n<div class="plyr__progress__container">\n<div class="plyr__progress">\n<input class="remote-only" data-plyr="seek" type="range" min="0" max="100" step="0.01" value="0" aria-label="Seek">\n<progress class="plyr__progress__buffer" min="0" max="100" value="0">% buffered</progress>\n<span role="tooltip" class="plyr__tooltip">00:00</span>\n</div>\n</div>\n<button type="button" class="plyr__control" aria-label="Mute" data-plyr="mute">\n<svg class="icon--pressed" role="presentation"><use xlink:href="#plyr-muted"></use></svg>\n<svg class="icon--not-pressed" role="presentation"><use xlink:href="#plyr-volume"></use></svg>\n<span class="label--pressed plyr__tooltip" role="tooltip">Unmute</span>\n<span class="label--not-pressed plyr__tooltip" role="tooltip">Mute</span>\n</button>\n<div class="plyr__volume">\n<input data-plyr="volume" type="range" min="0" max="1" step="0.05" value="1" autocomplete="off" aria-label="Volume">\n</div>\n<div class="plyr__controls__item plyr__time--current plyr__time" aria-label="Current time"></div>\n<button type="button" class="plyr__control" data-plyr="fullscreen">\n<svg class="icon--pressed" role="presentation"><use xlink:href="#plyr-exit-fullscreen"></use></svg>\n<svg class="icon--not-pressed" role="presentation"><use xlink:href="#plyr-enter-fullscreen"></use></svg>\n<span class="label--pressed plyr__tooltip" role="tooltip">Exit fullscreen</span>\n<span class="label--not-pressed plyr__tooltip" role="tooltip">Enter fullscreen</span>\n</button>\n</div>\n',ratio:"21:9",clicktoPlay:"false"}),this.hideControls(),window.playerStore.subscribe(()=>{const t=window.playerStore.getState();switch(console.log(t.isremote),t.isremote){case!0:this.showControls();break;default:this.hideControls()}if(!t.isremote){switch(t.playerState.paused){case!0:this.Player.pause();break;default:this.Player.play()}this.Player.currentTime=t.playerState.currtime}}),this.Player.onplay=()=>{window.playerStore.getState().isremote&&window.playerStore.dispatch({type:"CHANGE_STATE",playerState:{paused:this.Player.paused,currtime:this.Player.currentTime}})},this.Player.onpause=()=>{window.playerStore.getState().isremote&&window.playerStore.dispatch({type:"CHANGE_STATE",playerState:{paused:this.Player.paused,currtime:this.Player.currentTime}})},this.Player.onseeked=()=>{window.playerStore.getState().isremote&&window.playerStore.dispatch({type:"CHANGE_STATE",playerState:{paused:this.Player.paused,currtime:this.Player.currentTime}})},this.client=new f.a,this.client.add(t,t=>{console.log(t);t.files.find(t=>t.name.endsWith(".mp4")).renderTo(this.vidElem,{controls:!1}),console.log(this.Player),this.client.on("error",t=>{console.log(t)})})}hideControls(){document.querySelectorAll(".remote-only").forEach(t=>{t.style.display="none",console.log("Hiding Controls")})}showControls(){document.querySelectorAll(".remote-only").forEach(t=>{t.style.display="",console.log("Showing Controls")})}};const w={isremote:!1,torrent:null,playerState:{paused:!0,currtime:0}};function _(t=w.playerState,e){return e}var S=function(t=w,e){switch(e.type){case"CHANGE_STATE":return{...t,playerState:_(t.playerState,e.playerState)};case"SET_REMOTE":return{...t,isremote:!t.isremote};case"TORRENT_LEARNED":return{...t,torrent:e.torrent};default:return t}};var k=function(t,e){window.playerStore=Object(m.a)(S),t.innerHTML=v()(),e.ontorrentlearned=t=>{console.log(t);new b(t,document.getElementById("videlem"))},e.onremoteuserset=()=>{window.playerStore.dispatch({type:"SET_REMOTE"})}};function E(t,e,n,s){const l=document.getElementById("dropzone"),r=document.getElementById("enteroom");r.disabled=!0;let c=null;r.onclick=()=>{if(null!==e.displayName){const o=new h(e.uid,e.displayName,s,n,c);k(t,o)}},o()(l,t=>{if(e=t[0],".torrent"===i.a.extname(e.name).toLowerCase()){const e=a()(t[0]),n=e.files.find(t=>".mp4"===t.name.slice(-4));n?(c=a.a.toMagnetURI(e),document.getElementById("torrentname").innerHTML="File to be played: "+n.name,r.disabled=!1,console.log(c)):alert("Forgot to mention this player only can play mp4 and your torrent doesnt have one")}else alert('Are you illiterate ? The box clearly says "DRAG AND DROP TORRENT FILE" ');var e})}e.default=function(t,e,n,s=null){t.innerHTML=p()({isJoin:s});const o=navigator.mediaDevices.getUserMedia({audio:!0,video:!1});window.Auth.onAuthStateChanged(l=>{!function(t){const e=document.getElementById("displayname");t.displayName&&(e.value=t.displayName),e.onchange=()=>{t.updateProfile({displayName:e.value}).then(()=>{})}}(l),document.getElementById("enteroom").disabled=!1,s?n.child(s).once("value",i=>{console.log(i),null===i.val()&&(e.navigate("/"),alert("Room Not Found")),o.then(e=>{!function(t,e,n,s,o){document.getElementById("enteroom").onclick=()=>{if(void 0!==e.displayName){const l=new h(e.uid,e.displayName,s,n,null,o);k(t,l)}}}(t,l,e,n,s)}).catch(t=>{alert(t)}),console.log("Joinroom mode")}):(o.then(e=>{E(t,l,e,n)}).catch(t=>{alert(t)}),console.log("createroommode"))})}},70:function(t,e){},72:function(t,e){},74:function(t,e){},95:function(t,e,n){var s=n(19);t.exports=(s.default||s).template({1:function(t,e,n,s,o){return"Join"},3:function(t,e,n,s,o){return"Create"},5:function(t,e,n,s,o){return'\t\t<div class="row">\n\n\t\t\t<div class="col-8 mx-auto" >\n\t\t\t\t<div id="dropzone" class="d-flex justify-content-center" style="height:40vh;border-style:dashed;border-color:grey;border-radius:20px">\n\t\t\t\t\t<h1 class="display-4 text-muted align-self-center">Drag And Drop Torrent File</h1>\n\t\t\t\t</div>\n\t\t\t\t<h4 id="torrentname" class="text-success"></h4>\n\t\t\t</div>\n\t\t</div>\n'},compiler:[8,">= 4.3.0"],main:function(t,e,n,s,o){var l,i=null!=e?e:t.nullContext||{},r=t.lookupProperty||function(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]};return'\n <div class="container">\n\t\t<div class="row" style="height:40vh">\n\t\t\t\n\t\t\t<div class="col-auto align-self-end mx-auto">\n\t\t\t\t<label>Display Name:</label>\n\t\t\t\t<input id="displayname" type="text" class="form-control ">\n\t\t\t</div>\n\n\t\t</div>\n\t\t<div class="row">\n\n\t\t\t<div class="col mx-auto">\n\t\t\t\t<div class="text-center">\n\t\t\t\t<button id="enteroom" disabled=true type="button" class="btn btn-outline-success btn-lg float-none mt-2 mb-3">'+(null!=(l=r(n,"if").call(i,null!=e?r(e,"isJoin"):e,{name:"if",hash:{},fn:t.program(1,o,0),inverse:t.program(3,o,0),data:o,loc:{start:{line:15,column:114},end:{line:15,column:153}}}))?l:"")+"</button>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t</div>\n"+(null!=(l=r(n,"unless").call(i,null!=e?r(e,"isJoin"):e,{name:"unless",hash:{},fn:t.program(5,o,0),inverse:t.noop,data:o,loc:{start:{line:20,column:2},end:{line:30,column:13}}}))?l:"")+"\t</div>\n"},useData:!0})},96:function(t,e,n){var s=n(19);t.exports=(s.default||s).template({compiler:[8,">= 4.3.0"],main:function(t,e,n,s,o){return'\t<div class="container-fluid" style="height:100vh;">\n\t\t<div class="d-flex flex-column h-100 p-1" >\n\t\t<div class="row mb-1">\n\t\t\t<div class="col-8">\n\t\t\t\t<video id="videlem" class="video-js vjs-default-skin vjs-big-play-centered" controls ></video>\n\t\t\t</div>\n\n\t\t\t<div class="col-4">\n\t\t\t\t<div class="card h-100">\n\t\t\t\t\t<div class="card-body">\n\t\t\t\t\t<h3 class="card-title">Watchers :</h3>\n\t\t\t\t\t</div>\n\t\t\t\t\t<ul class="list-group">\n\t\t\t\t\t</ul>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t\t<div class="row flex-grow-1">\n\t\t\t<div class="col-8">\n\t\t\t\t<div class="card h-100" >\n\t\t\t\t\t<div class="card-body">\n\t\t\t\t\t<h3 class="card-title">Chat :</h3>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t<div class="col-4 align-self-center">\n\t\t\t\t<button type="button" class="btn btn-outline-secondary btn-lg mx-auto"> Mute </button>\n\t\t\t\t<button type="button" class="btn btn-outline-danger btn-lg mx-auto"> Disconnect </button>\n\t\t\t</div>\n\t\t</div>\n\t\t</div>\n\t</div>\n'},useData:!0})}}]);