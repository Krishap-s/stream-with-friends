(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{70:function(e,t){},72:function(e,t){},74:function(e,t){},95:function(e,t,n){var o=n(22);e.exports=(o.default||o).template({1:function(e,t,n,o,s){return"Join"},3:function(e,t,n,o,s){return"Create"},5:function(e,t,n,o,s){return'\t\t<div class="row">\n\n\t\t\t<div class="col-8 mx-auto" >\n\t\t\t\t<div id="dropzone" class="d-flex justify-content-center" style="height:50vh;border-style:dashed;border-color:grey;border-radius:20px">\n\t\t\t\t\t<h1 class="display-4 text-muted align-self-center">Drag And Drop Torrent File</h1>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n'},compiler:[8,">= 4.3.0"],main:function(e,t,n,o,s){var i,a=null!=t?t:e.nullContext||{},r=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'\n <div class="container">\n\t\t<div class="row" style="height:40vh">\n\t\t\t\n\t\t\t<div class="col-auto align-self-end mx-auto">\n\t\t\t\t<label>Display Name:</label>\n\t\t\t\t<input id="displayname" type="text" class="form-control ">\n\t\t\t</div>\n\n\t\t</div>\n\t\t<div class="row">\n\n\t\t\t<div class="col mx-auto">\n\t\t\t\t<div class="text-center">\n\t\t\t\t<button id="enteroom" type="button" class="btn btn-outline-success btn-lg float-none mt-2 mb-3">'+(null!=(i=r(n,"if").call(a,null!=t?r(t,"isJoin"):t,{name:"if",hash:{},fn:e.program(1,s,0),inverse:e.program(3,s,0),data:s,loc:{start:{line:15,column:100},end:{line:15,column:139}}}))?i:"")+"</button>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t</div>\n"+(null!=(i=r(n,"unless").call(a,null!=t?r(t,"isJoin"):t,{name:"unless",hash:{},fn:e.program(5,s,0),inverse:e.noop,data:s,loc:{start:{line:20,column:2},end:{line:29,column:13}}}))?i:"")+"\t</div>\n"},useData:!0})},97:function(e,t,n){"use strict";n.r(t);var o=n(60),s=n.n(o),i=n(30),a=n.n(i),r=n(64),l=n.n(r);var c=class{constructor(e,t){let n;for(n of(this.pc=new RTCPeerConnection({iceServers:[{urls:"stun:stun.l.google.com:19302"}]}),this.fchannel=t,this.oncontrolmessage=null,this.onremotetrack=null,this.onremotecontrolchannel=null,this.onremotemessagechannel=null,e.getTracks()))this.pc.addTrack(n);this.remotechannel=this.pc.createDataChannel("controller",{negotiated:!0,id:0}),this.messagechannel=this.pc.createDataChannel("message",{negotiated:!0,id:1}),this.remotechannel.onopen=()=>{this.onremotecontrolchannel&&this.onremotecontrolchannel(this.remotechannel)},this.messagechannel.onopen=()=>{this.onremotemessagechannel&&this.onremotemessagechannel(this.messagechannel)},this.remotechannel.onmessage=e=>{this.oncontrolmessage&&this.oncontolmessage(JSON.parse(e.data))},this.pc.onicecandinate=e=>{this.fchannel.send(JSON.stringify({candinate:e.candinate}))},this.pc.ontrack=e=>{this.onremotetrack(e.track)},this.fchannel.onmessage=e=>{const t=JSON.parse(e);t.sdp&&("offer"===t.type?this.pc.setRemoteDescription(new RTCSessionDescription(t)).then(()=>{this.pc.createAnswer().then(e=>{console.log(e),this.pc.setLocalDescription(e),this.fchannel.send(JSON.stringify(e.toJSON()))})}):t.candinate?this.pc.addIceCandinate(new RTCIceCandinate(t.candinate)):this.pc.setRemoteDescription(new RTCSessionDescription(t)))}}call(){this.pc.createOffer().then(e=>{this.pc.setLocalDescription(e),this.fchannel.send(JSON.stringify(e))})}};var h=class{constructor(e,t){this.id=e,this.ref=t,this.onmessage=null,this.ref.on("child_added",e=>{(e=e.val()).id!==this.id&&this.onmessage&&this.onmessage(e.data)})}send(e){this.ref.push({id:this.id,data:e}).then(()=>{}).catch(e=>{console.error("Error writing new message to Firebase Database",e)})}};var d=class{constructor(e,t,n,o,s=null,i=null){this.uid=e,this.stream=o,console.log(this.stream),this.name=t,this.torrent=s,this.connList={},this.onremoteuserlearned=null,this.remoteuser=null,this.ontorrentlearned=null,this.onremotetrackadded=null,this.onremotecontrolchannel=null,this.onmessagechannel=null,this.ondataremoved=null,null===i?(this.roomRef=n.push(),this.roomRef.set({torrent:this.torrent,remoteiswith:this.uid}),this.roomRef.onDisconnect().remove(),this.id=this.roomRef.key):this.roomRef=n.child(i),console.log(this.connList),this.roomRef.child("remoteiswith").on("value",e=>{e.val()===this.uid&&(0===Object.keys(this.connList).length?this.roomRef.onDisconnect().remove():this.roomRef.child("remoteiswith").onDisconnect().set(Object.keys(this.connList)[0]),this.onremoteuserlearned&&this.onremoteuserlearned(e.val())),this.remoteuser=e.val()}),this.roomRef.child("torrent").once("value",e=>{this.torrent=e.val(),this.ontorrentlearned&&this.ontorrentlearned(this.torrent)}),this.currentUser=this.roomRef.child("connList").child(this.uid),this.currentUser.set(this.name),this.currentUser.onDisconnect().remove(),this.roomRef.child("connList").on("child_added",(e,t)=>{if(e.key===this.uid)return;0===Object.keys(this.connList).length&&(this.roomRef.onDisconnect().cancel(),this.currentUser.onDisconnect().remove()),this.connList[e.key]=e.val(),this.uid===this.remoteuser&&this.roomRef.child("remoteiswith").onDisconnect().set(Object.keys(this.connList)[0]);const n=[e.key,this.uid];n.sort();const o=this.roomRef.child(`channels/${n[0]}/${n[1]}`),s=new c(this.stream,new h(this.uid,o));this.uid===n[0]&&s.call(),s.onremotetrack=e=>{this.onremotetrackadded&&this.onremotetrackadded(e)},s.onremotecontrolchannel=e=>{console.log(e),this.onremotecontrolchanneladded&&this.onremotecontrolchanneladded(e)},s.onmessagechannel=e=>{this.onmessagechanneladded&&this.onmessagechanneladded(e)}}),this.roomRef.child("connList").on("child_removed",e=>{e.key!==this.uid&&(delete this.connList[e.key],console.log(this.connList),this.ondataremoved&&this.ondataremoved(e.key))})}ChangeRemote(e){this.roomRef.child("remoteiswith").set(e),this.roomReF.child("remoteiswith").onDisconnect().cancel()}},m=n(95),u=n.n(m);let p,f,g,v,y,w;function k(){const e=document.getElementById("dropzone");let t;document.getElementById("enteroom").onclick=()=>{if(void 0!==w.displayName&&void 0!==t){new d(w.uid,w.displayName,f,y,t)}},s()(e,(e,n,o,s)=>{var i;i=e[0],".torrent"===a.a.extname(i.name).toLowerCase()&&(t=l.a.toMagnetURI(e[0]),console.log(t))})}function R(){const e=document.getElementById("displayname");w.displayName&&(e.value=w.displayName),e.onchange=()=>{w.updateProfile({displayName:e.value}).then(()=>{})},null===g?(console.log("createroommode"),k()):(console.log("joinroommode"),document.getElementById("enteroom").onclick=()=>{void 0!==w.displayName&&new d(w.uid,w.displayName,f,y,null,g)})}window.Auth.onAuthStateChanged(e=>{w=e}),console.log(l.a),navigator.mediaDevices.getUserMedia({audio:!0,video:!1}).then(e=>{y=e}).catch(e=>{alert(e)});t.default=function(e,t,n,o=null){v=e,g=o,f=n,p=t,v.innerHTML=u()({isJoin:g}),g?f.child(g).once("value",e=>{console.log(e),e.val()?R():(alert("Room Does Not Exist"),p.navigate("/"))}):R()}}}]);